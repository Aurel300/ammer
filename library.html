<!DOCTYPE html><html><head>
	<title>Native library development – ammer manual</title>
	<meta charset="utf-8">
	<link rel="stylesheet" href="css/style.css" media="all">
</head><body>
	<header><a href="index.html"><h1>ammer</h1></a></header>
	<nav id="menu"><ul><li><a href="index.html">Introduction</a></li><ul><li><a href="intro-start.html">Getting started</a></li></ul><ul><li><a href="intro-installation.html">Installation</a></li></ul><ul><li><a href="intro-sample.html">Sample project</a></li></ul><ul><li><a href="intro-use.html">Use cases</a></li></ul><ul><li><a href="intro-troubleshooting.html">Troubleshooting</a></li></ul></ul><ul><li><a href="definition.html">Definition</a></li><ul><li><a href="definition-library.html">Library definition</a></li><ul><li><a href="definition-library-functions.html">Functions</a></li></ul><ul><li><a href="definition-library-constants.html">Constants</a></li></ul><ul><li><a href="definition-link.html">Linking subdefinitions</a></li></ul></ul><ul><li><a href="definition-sub.html">Sublibraries</a></li></ul><ul><li><a href="definition-type.html">Library datatype definition</a></li><ul><li><a href="definition-type-nested.html">Nested data</a></li></ul></ul><ul><li><a href="definition-enum.html">Enumerations</a></li></ul><ul><li><a href="definition-metadata.html">Metadata</a></li></ul><ul><li><a href="definition-ffi.html">FFI types</a></li><ul><li><a href="definition-ffi-size.html">Size types</a></li></ul><ul><li><a href="definition-ffi-callbacks.html">Callbacks</a></li></ul></ul></ul><ul><li><a href="configuration.html">Configuration</a></li><ul><li><a href="configuration-general.html">General configuration</a></li></ul><ul><li><a href="configuration-library.html">Library configuration</a></li></ul></ul><ul><li><a href="target.html">Target details</a></li><ul><li><a href="target-hxcpp.html">C++</a></li></ul><ul><li><a href="target-eval.html">Eval</a></li></ul><ul><li><a href="target-hashlink.html">HashLink</a></li></ul><ul><li><a href="target-lua.html">Lua</a></li></ul></ul><ul><li><a href="library.html">Native library development</a></li></ul><ul><li><a href="ammer.html">Implementation details</a></li><ul><li><a href="ammer-testing.html">Testing</a></li></ul><ul><li><a href="ammer-stages.html">Compilation stages</a></li></ul></ul></nav>
	<main><h2>Native library development</h2><h3 id="library-tips">General notes about dynamic libraries</h3><p>If you are creating a native library from scratch, ensure that it is compiled as a dynamic library. See the sample project makefiles (<a href="https://github.com/Aurel300/ammer/blob/master/samples/poc/native/Makefile.win" target="_blank">Windows</a>, <a href="https://github.com/Aurel300/ammer/blob/master/samples/poc/native/Makefile.osx" target="_blank">OS X</a>, and <a href="https://github.com/Aurel300/ammer/blob/master/samples/poc/native/Makefile.linux" target="_blank">Linux</a>) for the compiler configuration necessary to correctly produce a dynamic library (<code>.dll</code>, <code>.dylib</code>, and <code>.so</code>, respectively).</p>
<p>To actually use a dynamic library at run-time, it must be present in a place in which the OS will know to look. This differs from platform to platform:</p>
<ul>
<li>Windows - DLLs in the current working directory will be used</li>
<li>OS X - the dynamic linker will look in <code>/usr/lib</code>, <code>/usr/local/lib</code>, paths specified in the environment variables <code>DYLD_LIBRARY_PATH</code>, <code>DYLD_FALLBACK_LIBRARY_PATH</code>, <code>DYLD_VERSIONED_LIBRARY_PATH</code>, the special <code>@executable_path</code>, and more (see  <a href="https://www.mikeash.com/pyblog/friday-qa-2009-11-06-linking-and-install-names.html" target="_blank">https://www.mikeash.com/pyblog/friday-qa-2009-11-06-linking-and-install-names.html</a>)<ul>
<li>during development, run the executable as <code>DYLD_LIBRARY_PATH=&lt;path to where the .dylib is&gt; &lt;run project&gt;</code></li>
</ul>
</li>
<li>Linux - the dynamic linker will look in <code>/usr/lib</code>, <code>/usr/local/lib</code>, paths specified in the environment variables <code>LD_LIBRARY_PATH</code>, and possibly more<ul>
<li>during development, run the executable as <code>LD_LIBRARY_PATH=&lt;path to where the .so is&gt; &lt;run project&gt;</code></li>
</ul>
</li>
</ul>
</main>
	<a id="page-prev" href="target-lua.html">« Previous: Lua</a>
	<a id="page-next" href="ammer.html">Next: Implementation details »</a>
	<footer>
		<a href="https://github.com/Aurel300/ammer/blob/gh-pages/source/content/05-library.md">Contribute to this page</a>
		| <a href="https://github.com/Aurel300/ammer/" target="_blank"><code>ammer</code> on GitHub</a>
		| &copy; 2019-2020 Aurel Bílý
	</footer>
</body></html>